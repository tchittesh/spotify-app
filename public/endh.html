
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
<link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Roboto'>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
table{background-color:#87CEEB;}
td,th{border:1px solid #aaa;text-align:left;padding:8px}
td{background-color:#fff}
th{background-color:#c4c4c4}
html,body,h1,h2,h3,h4,h5,h6 {font-family: "Roboto", sans-serif}
body {
    background-image: url("");
    background-repeat: no-repeat;
    background-position: right top;
    margin-right: 200px;
    background-attachment: fixed;
}
</style>
</head>
<body class="w3-light-grey">
    <header class="w3-container w3-light-blue w3-center w3-margin-top w3-card">
  <h2><font style="font:115%/1.3 Arial,Helvetica,sans-serif"> Joined group successfully. </font></h2>
</header>
<div align=CENTER>
  <br />
  <text id='text-box'>Safe to close tab now.</text>
  <br />
  <br />
  <text>People in this room:</text>
  <br />
  <text id='list-of-names'>host</text>
  <br />
  <br />
  <text>Playlist:</text>
  <br />
  <text id='playlist'>_</text>
  <br />
  <br />
  <a id='lock-button' class="btn btn-primary">Lock</a>
  <!-- <br /> -->
  <!-- <br /> -->
  <!-- <iframe id='web-player' visibility='hidden' src="" width="300" height="380" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe> -->
</div>
<script>
var roomcode = window.location.hash.substring(1,);
document.getElementById('text-box').innerHTML = "Your room code is "+roomcode;
</script>
<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
<script>
setInterval(function() {
  $.get("/getlistnames", {roomcode : window.location.hash.substring(1,)}, function(data) {
    document.getElementById('list-of-names').innerHTML = data;
  });
  $.get("/getgroupplaylist", {roomcode : window.location.hash.substring(1,)}, function(data) {
    document.getElementById('playlist').innerHTML = data;
  });
}, 1000);
</script>
<script>
(function() {
  document.getElementById('lock-button').addEventListener('click', function() {
    $.get("/getgroupplaylist", {roomcode : window.location.hash.substring(1,)}, function(data) {
      // console.log(data);
      document.getElementById('playlist').innerHTML = data;
      $.get("/gethostplaylistcode", {roomcode : window.location.hash.substring(1,)}, function(data1) {
        hostcode = JSON.parse(data1).hostcode;
        // console.log(hostcode);
        playlistcode = JSON.parse(data1).playlistcode;
        // console.log(playlistcode);
        // console.log(document.getElementById('web-player').style);
        newsrc = 'https://open.spotify.com/embed/user/'+hostcode+'/playlist/'+playlistcode;
        // window.open(newsrc);
        window.location.href = newsrc;
        // document.getElementById('web-player').src = newsrc;
        // document.getElementById('web-player').style.visibility = 'visible';
      });
    });
  }, false);
})();
</script>
</body>
</html>
